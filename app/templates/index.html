<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>JIIT PVQ - Previous Year Question Papers of JIIT</title>
	</head>
	<body>
		<div class="container" id="container">
			<!-- <div class="form-container sign-up-container">
        <form action="#">
          <h1>Create Account</h1>
          <div class="social-container">
            <a href="#" class="social"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social"><i class="fab fa-google-plus-g"></i></a>
            <a href="#" class="social"><i class="fab fa-linkedin-in"></i></a>
          </div>
          <span>or use your email for registration</span>
          <input type="text" placeholder="Name" />
          <input type="email" placeholder="Email" />
          <input type="password" placeholder="Password" />
          <button id="main_signup">Sign Up</button>
        </form>
      </div> -->
			<div class="form-container sign-up-container">
				<form action="#">
					<h1>Upload Here</h1>
					<span>or Check if it is already present </span>
					<input type="text" placeholder="Name" />
					<input type="email" placeholder="Email" />
					<input type="password" placeholder="Password" />
					<button id="main_signup">Upload</button>
				</form>
			</div>
			<!-- animation div -->
			<div class="data-container">
				<button>Proceed</button>
			</div>

			<div class="form-container sign-in-container">
				<!-- <form action="#">
          <h1>Sign in</h1>
          <div class="social-container">
            <a href="#" class="social"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social"><i class="fab fa-google-plus-g"></i></a>
            <a href="#" class="social"><i class="fab fa-linkedin-in"></i></a>
          </div>
          <span>or use your account</span>
          <input type="email" placeholder="Email" />
          <input type="password" placeholder="Password"/>
          <a href="#">Forgot your password?</a>
          <button>Sign In</button>
        </form> -->
				<form id="search-form">
					<!-- Dept selector -->
					<div style="display: flex; flex-direction: row">
						<label for="dept">Select a Department:</label>
						<select name="dept" id="dept">
							<option value="cse">CSE</option>
							<option value="ece">ECE</option>
							<option value="it">IT</option>
							<option value="biotech">Biotech</option>
						</select>
					</div>
					<br />

					<!-- Year selector -->
					<div style="display: flex; flex-direction: row">
						<label for="clgyear">Year: </label>
						<input
							type="radio"
							id="i"
							name="clgyear"
							value="i"
							checked
						/>
						<label for="first">I</label>

						<input type="radio" id="ii" name="clgyear" value="ii" />
						<label for="second">II</label>

						<input
							type="radio"
							id="iii"
							name="clgyear"
							value="iii"
						/>
						<label for="third">III</label>

						<input type="radio" id="iv" name="clgyear" value="iv" />
						<label for="fourth">IV</label>
					</div>
					<br />
					<!-- Semester selector -->
					<div style="display: flex; flex-direction: row">
						<label for="sem">Semester: </label>

						<input type="radio" id="odd" name="sem" value="odd" />
						<label for="odd">Odd</label>

						<input
							type="radio"
							id="even"
							name="sem"
							value="even"
							checked
						/>
						<label for="even">Even</label>
					</div>
					<br />

					<!-- Exam -->
					<div style="display: flex; flex-direction: row">
						<label for="exam">Exam: </label>
						<input
							type="radio"
							id="t1"
							name="exam"
							value="t1"
							checked
						/>
						<label for="exam">T1</label>

						<input type="radio" id="t2" name="exam" value="t2" />
						<label for="t2">T2</label>

						<input type="radio" id="exam" name="exam" value="t3" />
						<label for="t3">T3</label>
					</div>
					<br />

					<!-- Subject selector -->
					<div style="display: flex; flex-direction: row">
						<label for="subject">Select a Subject: </label>
						<select name="subject" id="subject"></select>
					</div>
					<br />
					<button onclick="getFiles(event)" type="button">
						Find Question Papers
					</button>
				</form>
			</div>

			<div class="overlay-container">
				<div class="overlay">
					<div class="overlay-panel overlay-left">
						<h1>Welcome Back!</h1>
						<p>
							To keep connected with us please login with your
							personal info
						</p>
						<button class="ghost" id="signIn">
							FIND QUESTION PAPERS
						</button>
					</div>
					<div class="overlay-panel overlay-right">
						<h1>Hello, Friend!</h1>
						<p>
							Enter your personal details and start journey with
							us
						</p>
						<button class="ghost" id="signUp">
							REQUEST AN UPLOAD
						</button>
					</div>
				</div>
			</div>
		</div>
		<div id="files-container"></div>

		<style>
			@import url("https://fonts.googleapis.com/css?family=Montserrat:400,800");

			* {
				box-sizing: border-box;
			}

			body {
				background: #f6f5f7;
				display: flex;
				justify-content: center;
				align-items: center;
				flex-direction: column;
				font-family: "Montserrat", sans-serif;
				height: 100vh;
				margin: -20px 0 50px;
				background: #03a9f4;
			}

			body.right-panel-active {
				background: #f43648;
			}

			h1 {
				font-weight: bold;
				margin: 0;
			}

			h2 {
				text-align: center;
			}

			p {
				font-size: 14px;
				font-weight: 100;
				line-height: 20px;
				letter-spacing: 0.5px;
				margin: 20px 0 30px;
			}

			span {
				font-size: 12px;
			}

			a {
				color: #333;
				font-size: 14px;
				text-decoration: none;
				margin: 15px 0;
			}

			button {
				border-radius: 20px;
				border: 1px solid #000000;
				background: #000000;
				color: #ffffff;
				font-size: 12px;
				font-weight: bold;
				padding: 12px 45px;
				letter-spacing: 1px;
				text-transform: uppercase;
				transition: transform 80ms ease-in;
			}

			button:active {
				transform: scale(0.95);
			}

			button:focus {
				outline: none;
			}

			button.ghost {
				background-color: transparent;
				border-color: #ffffff;
			}

			form {
				background-color: #ffffff;
				display: flex;
				align-items: center;
				justify-content: center;
				flex-direction: column;
				padding: 0 50px;
				height: 100%;
				text-align: center;
			}

			input {
				background-color: #eee;
				border: none;
				padding: 12px 15px;
				margin: 8px 0;
				width: 100%;
			}

			.container {
				background-color: #fff;
				border-radius: 10px;
				box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
					0 10px 10px rgba(0, 0, 0, 0.22);
				position: relative;
				overflow: hidden;
				width: 768px;
				max-width: 100%;
				min-height: 480px;
			}

			.form-container {
				position: absolute;
				top: 0;
				height: 100%;
				transition: all 0.5s ease-in-out;
			}

			.sign-in-container {
				left: 0;
				width: 50%;
				z-index: 2;
			}

			.container.right-panel-active .sign-in-container {
				transform: translateX(100%);
			}

			.sign-up-container {
				left: 0;
				width: 50%;
				opacity: 0;
				z-index: 1;
			}

			.container.right-panel-active .sign-up-container {
				transform: translateX(100%);
				opacity: 1;
				z-index: 5;
				animation: show 0.5s;
			}

			@keyframes show {
				0%,
				49.99% {
					opacity: 0;
					z-index: 1;
				}

				50%,
				100% {
					opacity: 1;
					z-index: 5;
				}
			}

			.overlay-container {
				position: absolute;
				top: 0;
				left: 50%;
				width: 50%;
				height: 100%;
				overflow: hidden;
				transition: transform 0.3s ease-in-out;
				z-index: 100;
			}

			.container.right-panel-active .overlay-container {
				transform: translateX(-100%);
			}

			.overlay {
				background: #f43648;
				background-repeat: no-repeat;
				background-size: cover;
				background-position: 0 0;
				color: #ffffff;
				position: relative;
				left: -100%;
				height: 100%;
				width: 200%;
				transform: translateX(0);
				transition: transform 0.2s ease-in-out;
			}

			.container.right-panel-active .overlay {
				transform: translateX(50%);
			}

			.overlay-panel {
				position: absolute;
				display: flex;
				align-items: center;
				justify-content: center;
				flex-direction: column;
				padding: 0 40px;
				text-align: center;
				top: 0;
				height: 100%;
				width: 50%;
				transform: translateX(0);
				transition: transform 0.2s ease-in-out;
			}

			.overlay-left {
				transform: translateX(-20%);
			}

			.container.right-panel-active .overlay-left {
				transform: translateX(0);
			}

			.overlay-right {
				right: 0;
				transform: translateX(0);
				background: #03a9f4;
			}

			.container.right-panel-active .overlay-right {
				transform: translateX(20%);
			}

			.social-container {
				margin: 20px 0;
			}

			.social-container a {
				border: 1px solid #dddddd;
				border-radius: 50%;
				display: inline-flex;
				justify-content: center;
				align-items: center;
				margin: 0 5px;
				height: 40px;
				width: 40px;
			}

			.data-container {
				position: absolute;
				height: 100%;
				width: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
				background-color: aqua;
				/* transition: all 200ms linear; */
				z-index: 0;
				opacity: 0;
			}
			.active {
				animation-name: showpop;
				animation-duration: 2s;
				animation-timing-function: ease-in-out;
				opacity: 1;
				z-index: 500;
			}

			@keyframes showpop {
				0% {
					transform: translateY(-786px);
				}
				25% {
					transform: translateY(-550px);
				}
				50% {
					transform: translateY(-400px);
				}
				100% {
					transform: translateY(0px);
				}
			}
		</style>

		<script>
			const signUpButton = document.getElementById("signUp");
			const signInButton = document.getElementById("signIn");
			const container = document.getElementById("container");
			const main_signup = document.getElementById("main_signup");
			const body = document.querySelector("body");
			const data_container = document.querySelector(".data-container");

			signUpButton.addEventListener("click", () => {
				container.classList.add("right-panel-active");
				body.classList.add("right-panel-active");
				// showData.classList.add("active");
			});

			signInButton.addEventListener("click", () => {
				container.classList.remove("right-panel-active");
				body.classList.remove("right-panel-active");
			});

			main_signup.addEventListener("click", () => {
				data_container.classList.add("active");
			});

			// add event listeners
			document
				.querySelector("#dept")
				.addEventListener("change", getSubjects);

			document
				.querySelectorAll('input[name="sem"]')
				.forEach(function (radio) {
					radio.addEventListener("change", getSubjects);
				});

			document
				.querySelectorAll('input[name="clgyear"]')
				.forEach(function (radio) {
					radio.addEventListener("change", getSubjects);
				});

			async function getSubjects() {
				const dept = document.querySelector("#dept").value;
				const clgyear = document.querySelector(
					'input[name="clgyear"]:checked'
				).value;

				const sem = document.querySelector(
					'input[name="sem"]:checked'
				).value;

				const response = await fetch(
					`/subjects?dept=${dept}&year=${clgyear}&sem=${sem}`
				);
				const subjects = await response.json();
				updateSubjectOptions(subjects);
			}

			function updateSubjectOptions(subjects) {
				const select = document.querySelector("#subject");
				select.innerHTML = "";
				subjects.forEach(function (subject) {
					const option = document.createElement("option");
					option.value = subject;
					option.textContent = subject;
					select.appendChild(option);
				});
			}

			async function getFiles() {
				const dept = document.querySelector("#dept").value;
				const clgyear = document.querySelector(
					'input[name="clgyear"]:checked'
				).value;
				const sem = document.querySelector(
					'input[name="sem"]:checked'
				).value;
				const exam = document.querySelector(
					'input[name="exam"]:checked'
				).value;
				const subject = document.querySelector("#subject").value;

				const response = await fetch(
					`/get-files?dept=${dept}&year=${clgyear}&sem=${sem}&exam=${exam}&subject=${subject}`
				);

				const data = await response.json();

				const fileContainer =
					document.querySelector("#files-container");
				fileContainer.innerHTML = "";

				const break_line = document.createElement("br");
				if (data.length === 0) {
					fileContainer.textContent = "No results found.";
				} else {
					data.forEach(function (file) {
						const label = document.createElement("label");
						const checkbox = document.createElement("input");
						checkbox.type = "checkbox";
						checkbox.name = "file";
						checkbox.value = file;
						label.appendChild(checkbox);
						label.appendChild(document.createTextNode(file));
						fileContainer.appendChild(label);
						fileContainer.appendChild(document.createElement("br"));
					});

					const selectAllButton = document.createElement("button");
					selectAllButton.textContent = "Select All";
					selectAllButton.addEventListener("click", function () {
						document
							.querySelectorAll('input[name="file"]')
							.forEach(function (checkbox) {
								checkbox.checked = true;
							});
					});
					fileContainer.appendChild(selectAllButton);

					const downloadButton = document.createElement("button");
					downloadButton.textContent = "Download Selected";
					downloadButton.addEventListener("click", function () {
						const selectedFiles = Array.from(
							document.querySelectorAll(
								'input[name="file"]:checked'
							)
						).map(function (checkbox) {
							return checkbox.value;
						});
						if (selectedFiles.length > 0) {
							// Make post request with selected files
							console.log("Selected files:", selectedFiles);
						} else {
							console.log("No files selected.");
						}
					});
					fileContainer.appendChild(downloadButton);
				}

				// const container = document.querySelector(".form-container");
				// container.appendChild(fileContainer);
			}

			getSubjects();
		</script>
	</body>
</html>
